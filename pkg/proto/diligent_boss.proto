syntax = "proto3";

package proto;
option go_package = "./proto";

import "diligent_common.proto";

service Boss {
  // Ping
  rpc Ping (BossPingRequest) returns (BossPingResponse);

  // Minions Management
  rpc RegisterMinion (BossRegisterMinionRequest) returns (BossRegisterMinionResponse);
  rpc UnregisterMinion (BossUnregisterMinonRequest) returns (BossUnregisterMinionResponse);
  rpc ShowMinions (BossShowMinionRequest) returns (BossShowMinionResponse);

  // Workload Related
  rpc RunWorkload (BossRunWorkloadRequest) returns (BossRunWorkloadResponse);
  rpc StopWorkload (BossStopWorkloadRequest) returns (BossStopWorkloadResponse);
}

message BossPingRequest {
}

message BossPingResponse {
  BuildInfo build_info = 1;
  ProcessInfo process_info = 2;
}

message BossRegisterMinionRequest{
  string addr = 1;
}

message BossRegisterMinionResponse {
  GeneralStatus status = 1;
}

message BossUnregisterMinonRequest {
  string addr = 1;
}

message BossUnregisterMinionResponse {
  GeneralStatus status = 1;
}

message BossShowMinionRequest {
}

message BossShowMinionResponse {
  repeated MinionInfo minion_infos = 1;
}

message MinionInfo {
  string addr = 1;
  GeneralStatus reachability = 2;
  BuildInfo build_info = 3;
  ProcessInfo process_info = 4;
}

message MinionStatus {
  string addr = 1;
  GeneralStatus status = 2;
}

message BossRunWorkloadRequest {
  DataSpec data_spec = 1;
  DBSpec db_spec = 2;
  WorkloadSpec wl_spec = 3;
}

message BossRunWorkloadResponse {
  GeneralStatus overall_status = 1;
  repeated MinionStatus minion_statuses = 2;
}

message BossStopWorkloadRequest {
}

message BossStopWorkloadResponse {
  GeneralStatus overall_status = 1;
  repeated MinionStatus minion_statuses = 2;
}
